# =============================================================================
# FILTRO FAIL2BAN PARA AUTENTICACIÓN POSTGRESQL
# =============================================================================

[Definition]
# Detectar intentos de autenticación fallidos
failregex = ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*authentication failed for user.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*password authentication failed for user.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*no pg_hba.conf entry for.*$

# Ignorar conexiones locales y de Docker
ignoreregex = client=127\.0\.0\.1
              client=172\.20\..*
              client=172\.17\..*
              client=::1