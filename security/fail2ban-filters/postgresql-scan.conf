# =============================================================================
# FILTRO FAIL2BAN PARA ESCANEO POSTGRESQL
# =============================================================================

[Definition]
# Detectar escaneos de puertos y ataques de reconocimiento
failregex = ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*database ".*" does not exist.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*role ".*" does not exist.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*unsupported frontend protocol.*$

# Ignorar conexiones internas
ignoreregex = client=127\.0\.0\.1
              client=172\.20\..*
              client=172\.17\..*
              client=::1