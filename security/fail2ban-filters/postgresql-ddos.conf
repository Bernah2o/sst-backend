# =============================================================================
# FILTRO FAIL2BAN PARA DDOS POSTGRESQL
# =============================================================================

[Definition]
# Detectar patrones de DDoS y conexiones excesivas
failregex = ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*LOG:.*connection received.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*too many connections for role.*$
            ^.*\[.*\]: \[.*\] user=.*,db=.*,app=.*,client=<HOST>.*FATAL:.*remaining connection slots are reserved.*$

# Ignorar conexiones internas
ignoreregex = client=127\.0\.0\.1
              client=172\.20\..*
              client=172\.17\..*
              client=::1