# =============================================================================
# CONFIGURACIÃ“N FAIL2BAN PARA POSTGRESQL
# =============================================================================
# Compatible con imagen oficial crazymax/fail2ban

[postgresql-auth]
enabled = true
port = 5432
filter = postgresql-auth
logpath = /var/log/postgresql/postgresql-*.log
maxretry = 5
findtime = 600
bantime = 3600
action = iptables-multiport[name=postgresql-auth, port="5432", protocol=tcp]

[postgresql-ddos]
enabled = true
port = 5432
filter = postgresql-ddos
logpath = /var/log/postgresql/postgresql-*.log
maxretry = 10
findtime = 60
bantime = 1800
action = iptables-multiport[name=postgresql-ddos, port="5432", protocol=tcp]

[postgresql-scan]
enabled = true
port = 5432
filter = postgresql-scan
logpath = /var/log/postgresql/postgresql-*.log
maxretry = 3
findtime = 300
bantime = 7200
action = iptables-multiport[name=postgresql-scan, port="5432", protocol=tcp]