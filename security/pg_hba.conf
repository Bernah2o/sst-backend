# =============================================================================
# CONFIGURACIÓN DE AUTENTICACIÓN POSTGRESQL (pg_hba.conf)
# =============================================================================
# Configuración segura para contenedor Docker
# =============================================================================

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             postgres                                peer
local   all             all                                     scram-sha-256

# IPv4 local connections (dentro del contenedor)
host    all             postgres        127.0.0.1/32            reject
host    all             postgres        ::1/128                 reject

# Conexiones desde la red Docker (solo para la aplicación)
host    bd_sst          sstuser         172.20.0.0/16           scram-sha-256

# Conexiones desde localhost del host (para administración)
host    bd_sst          sstuser         172.17.0.0/16           scram-sha-256

# Rechazar todas las demás conexiones
host    all             all             0.0.0.0/0               reject
host    all             all             ::/0                    reject

# =============================================================================
# NOTAS DE SEGURIDAD:
# - Solo se permite conexión al usuario sstuser en la base bd_sst
# - Se usa autenticación scram-sha-256 (más segura)
# - Se rechazan conexiones del usuario postgres desde red
# - Solo se permiten conexiones desde redes Docker internas
# =============================================================================