-- =====================================================
-- CATÁLOGO DE FACTORES DE RIESGO
-- =====================================================

-- Factores Físicos
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Ruido', 'fisico', 'Exposición a niveles de ruido que pueden afectar la audición', '85 dB'),
('Temperatura Alta', 'fisico', 'Exposición a temperaturas elevadas', '>30°C'),
('Temperatura Baja', 'fisico', 'Exposición a temperaturas bajas', '<15°C'),
('Radiaciones Ionizantes', 'fisico', 'Exposición a rayos X, gamma, etc.', 'Según normativa'),
('Radiaciones No Ionizantes', 'fisico', 'Exposición a luz UV, microondas, etc.', 'Según normativa'),
('Vibración', 'fisico', 'Vibraciones mecánicas transmitidas al cuerpo', '>2.5 m/s²'),
('Iluminación', 'fisico', 'Niveles inadecuados de iluminación', '<300 lux');

-- Factores Químicos
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Polvos', 'quimico', 'Partículas sólidas en suspensión', '>5 mg/m³'),
('Gases', 'quimico', 'Gases tóxicos o irritantes', 'Según TLV'),
('Líquidos', 'quimico', 'Sustancias químicas en estado líquido', 'Según SDS'),
('Humos', 'quimico', 'Partículas de combustión', '>3 mg/m³'),
('Fibras', 'quimico', 'Fibras minerales o sintéticas', '>0.1 fibras/cm³');

-- Factores Biológicos
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Virus', 'biologico', 'Exposición a agentes virales', 'Según patógeno'),
('Bacterias', 'biologico', 'Exposición a agentes bacterianos', 'Según patógeno'),
('Hongos', 'biologico', 'Exposición a esporas y hongos', '>500 UFC/m³'),
('Parásitos', 'biologico', 'Exposición a agentes parasitarios', 'Según vector');

-- Factores Ergonómicos
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Movimientos Repetitivos', 'ergonomico', 'Movimientos repetidos de extremidades', '>15 rep/min'),
('Carga Dinámica', 'ergonomico', 'Levantamiento y transporte de cargas', '>25 kg'),
('Carga Estática', 'ergonomico', 'Posturas prolongadas', '>2 horas'),
('Manejo de Cargas', 'ergonomico', 'Manipulación manual de cargas', '>10 kg'),
('Diseño de Puesto', 'ergonomico', 'Diseño inadecuado del puesto de trabajo', 'Evaluación'),
('Video Terminales', 'ergonomico', 'Trabajo con pantallas de visualización', '>4 horas/día');

-- Factores Psicosociales
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Estrés Laboral', 'psicosocial', 'Condiciones que generan estrés', 'Batería riesgo'),
('Carga Mental', 'psicosocial', 'Demanda cognitiva del trabajo', 'Batería riesgo'),
('Atención al Público', 'psicosocial', 'Interacción con clientes/usuarios', 'Evaluación');

-- Factores de Seguridad
INSERT INTO factores_riesgo (nombre, categoria, descripcion, nivel_accion) VALUES
('Trabajo en Alturas', 'seguridad', 'Trabajo a más de 1.5 metros de altura', '>1.5 m'),
('Espacios Confinados', 'seguridad', 'Trabajo en espacios con ventilación limitada', 'Permiso'),
('Maquinaria', 'seguridad', 'Operación de maquinaria peligrosa', 'Capacitación'),
('Eléctrico', 'seguridad', 'Exposición a riesgo eléctrico', '>50 V');

-- =====================================================
-- CATÁLOGO DE TIPOS DE EXÁMENES
-- =====================================================

-- Exámenes Clínicos
INSERT INTO tipos_examen (codigo, nombre, categoria, descripcion) VALUES
('EMO', 'Examen Médico Ocupacional', 'Clínico', 'Evaluación médica general con énfasis osteomuscular'),
('EMO_DERM', 'Examen Médico con Énfasis Dermatológico', 'Clínico', 'Evaluación médica con énfasis en piel'),
('EMO_RESP', 'Examen Médico con Énfasis Respiratorio', 'Clínico', 'Evaluación médica con énfasis en sistema respiratorio');

-- Exámenes Funcionales
INSERT INTO tipos_examen (codigo, nombre, categoria, descripcion) VALUES
('AUDIO', 'Audiometría', 'Funcional', 'Evaluación de la función auditiva'),
('ESPIRO', 'Espirometría', 'Funcional', 'Evaluación de la función pulmonar'),
('ESPIRO_BRONCO', 'Espirometría con Broncodilatador', 'Funcional', 'Prueba respiratoria con broncodilatador'),
('OPTO', 'Optometría', 'Funcional', 'Evaluación de la función visual'),
('EKG', 'Electrocardiograma', 'Funcional', 'Evaluación de la función cardíaca');

-- Exámenes de Imagen
INSERT INTO tipos_examen (codigo, nombre, categoria, descripcion) VALUES
('RX_TORAX', 'Radiografía de Tórax', 'Imagen', 'Estudio radiológico del tórax'),
('RX_LUMBAR', 'Radiografía de Columna Lumbosacra', 'Imagen', 'Estudio radiológico de columna lumbar'),
('RX_CERVICAL', 'Radiografía de Columna Cervical', 'Imagen', 'Estudio radiológico de columna cervical');

-- Laboratorio Clínico
INSERT INTO tipos_examen (codigo, nombre, categoria, descripcion) VALUES
('CH', 'Cuadro Hemático', 'Laboratorio', 'Análisis de células sanguíneas'),
('HG_IV', 'Hemograma Tipo IV', 'Laboratorio', 'Hemograma completo con recuento diferencial'),
('GLICEMIA', 'Glicemia', 'Laboratorio', 'Medición de glucosa en sangre'),
('P_ORINA', 'Parcial de Orina', 'Laboratorio', 'Análisis básico de orina'),
('BUN_CREAT', 'BUN y Creatinina', 'Laboratorio', 'Evaluación de función renal'),
('PERFIL_LIP', 'Perfil Lipídico', 'Laboratorio', 'Colesterol, triglicéridos, HDL, LDL'),
('TSH', 'TSH', 'Laboratorio', 'Hormona estimulante de tiroides'),
('BILIRRUBINA', 'Bilirrubina Total y Directa', 'Laboratorio', 'Evaluación de función hepática'),
('FOSFATASA', 'Fosfatasa Alcalina', 'Laboratorio', 'Enzima hepática'),
('PLOMO', 'Niveles de Plomo en Sangre', 'Laboratorio', 'Medición de plomo sanguíneo');

-- Exámenes Especiales
INSERT INTO tipos_examen (codigo, nombre, categoria, descripcion) VALUES
('VDRL', 'VDRL', 'Laboratorio', 'Detección de sífilis'),
('FSH_LH', 'FSH y LH', 'Laboratorio', 'Hormonas reproductivas'),
('ESPERMATOGRAMA', 'Espermatograma', 'Laboratorio', 'Análisis de semen'),
('PSICO', 'Evaluación Psicológica', 'Funcional', 'Evaluación psicológica ocupacional');

-- =====================================================
-- CATÁLOGO DE CRITERIOS DE EXCLUSIÓN
-- =====================================================

-- Criterios Visuales
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('VIS_01', 'Visión no corregida < 20/30', 'Agudeza visual cercana o lejana inferior a 20/30 binocular no corregida o inadecuadamente corregida', 'Visual'),
('VIS_02', 'Patologías visuales graves', 'Cataratas avanzadas, glaucoma no controlado, desprendimiento de retina', 'Visual');

-- Criterios Osteomusculares
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('OST_01', 'Trastornos trauma acumulativo', 'Patologías osteomusculares de extremidad superior (túnel carpiano, epicondilitis, tendinitis) con antecedentes menor a un año o sintomatología actual', 'Osteomuscular'),
('OST_02', 'Lesiones columna cervical', 'Patologías de columna cervical no funcionales, limitantes, sintomáticas durante el último año', 'Osteomuscular'),
('OST_03', 'Lesiones columna lumbar', 'Hernias discales lumbares, escoliosis severa, espondilolistesis sintomática', 'Osteomuscular'),
('OST_04', 'Hernias inguinales/umbilicales', 'Hernias inguinales o umbilicales no corregidas', 'Osteomuscular');

-- Criterios Auditivos
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('AUD_01', 'Hipoacusia Larsen II o III', 'Hipoacusia según clasificación de Larsen Modificado grado II o III', 'Auditivo'),
('AUD_02', 'Hipoacusia mixta', 'Hipoacusia mixta (conductiva y neurosensorial)', 'Auditivo');

-- Criterios Respiratorios
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('RESP_01', 'Patrón respiratorio anormal', 'Anormalidad en el patrón respiratorio (restrictivo, obstructivo, mixto)', 'Respiratorio'),
('RESP_02', 'Enfermedades pulmonares crónicas', 'EPOC, asma no controlada, fibrosis pulmonar', 'Respiratorio');

-- Criterios Hematológicos
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('HEM_01', 'Alteraciones hematológicas', 'Anemia severa, trastornos de coagulación no controlados', 'Hematológico');

-- Criterios Cardiovasculares
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('CARD_01', 'Hipertensión no controlada', 'Hipertensión arterial no controlada con medicamentos', 'Cardiovascular'),
('CARD_02', 'Cardiopatías', 'Enfermedad coronaria, arritmias graves, insuficiencia cardíaca', 'Cardiovascular');

-- Criterios Metabólicos
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('MET_01', 'Diabetes no controlada', 'Diabetes mellitus no controlada con complicaciones', 'Metabólico');

-- Criterios Psicológicos
INSERT INTO criterios_exclusion (codigo, nombre, descripcion, sistema_afectado) VALUES
('PSI_01', 'Trastornos psiquiátricos graves', 'Trastornos psicóticos, depresión mayor no controlada, trastorno bipolar', 'Psicológico'),
('PSI_02', 'Dependencia sustancias', 'Dependencia activa a alcohol o sustancias psicoactivas', 'Psicológico');

-- =====================================================
-- EJEMPLO: PROFESIOGRAMA PARA CARGO ADMINISTRATIVO
-- =====================================================

-- Asumiendo que tienes un cargo con id=1 llamado "Office Manager"
-- Este es un ejemplo de cómo se vería poblado

-- Insertar el profesiograma base
INSERT INTO profesiogramas (cargo_id, version, posicion_predominante, descripcion_actividades, periodicidad_emo_meses, justificacion_periodicidad_emo, nivel_riesgo_cargo) VALUES
(1, '1.0', 'Bípeda/sedente', 'Coordinación de actividades administrativas, manejo de documentación, atención telefónica, trabajo en computadora', 24, 'Periodicidad de 24 meses justificada por tratarse de cargo administrativo con exposición únicamente a factores ergonómicos (video terminales, carga estática). Controles implementados: pausas activas, ergonomía del puesto. Vigilancia epidemiológica sin tendencias de enfermedad laboral. Resolución 1843 de 2025, Art. 15.', 'medio');

-- Asociar factores de riesgo (asumiendo profesiograma_id = 1)
INSERT INTO profesiograma_factores (profesiograma_id, factor_riesgo_id, nivel_exposicion, tiempo_exposicion) VALUES
(1, (SELECT id FROM factores_riesgo WHERE nombre = 'Video Terminales'), 'alto', 8.0),
(1, (SELECT id FROM factores_riesgo WHERE nombre = 'Carga Estática'), 'medio', 6.0),
(1, (SELECT id FROM factores_riesgo WHERE nombre = 'Movimientos Repetitivos'), 'medio', 8.0),
(1, (SELECT id FROM factores_riesgo WHERE nombre = 'Estrés Laboral'), 'medio', 8.0);

-- Asociar exámenes de ingreso
INSERT INTO profesiograma_examenes (profesiograma_id, tipo_examen_id, tipo_evaluacion, periodicidad_meses, obligatorio) VALUES
(1, (SELECT id FROM tipos_examen WHERE codigo = 'EMO'), 'ingreso', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'OPTO'), 'ingreso', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'AUDIO'), 'ingreso', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'CH'), 'ingreso', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'GLICEMIA'), 'ingreso', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'P_ORINA'), 'ingreso', NULL, true);

-- Asociar exámenes periódicos (según periodicidad del profesiograma = 24 meses)
INSERT INTO profesiograma_examenes (profesiograma_id, tipo_examen_id, tipo_evaluacion, periodicidad_meses, obligatorio, justificacion_periodicidad) VALUES
(1, (SELECT id FROM tipos_examen WHERE codigo = 'EMO'), 'periodico', 24, true, 'Periodicidad de 24 meses según evaluación de riesgos del cargo administrativo. Res. 1843/2025'),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'OPTO'), 'periodico', 24, true, 'Evaluación visual cada 24 meses por uso de video terminales'),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'AUDIO'), 'periodico', 24, true, 'Audiometría cada 24 meses como vigilancia preventiva'),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'CH'), 'periodico', 24, true, 'Laboratorio de vigilancia cada 24 meses');

-- Asociar exámenes de retiro
INSERT INTO profesiograma_examenes (profesiograma_id, tipo_examen_id, tipo_evaluacion, periodicidad_meses, obligatorio) VALUES
(1, (SELECT id FROM tipos_examen WHERE codigo = 'EMO'), 'retiro', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'OPTO'), 'retiro', NULL, true),
(1, (SELECT id FROM tipos_examen WHERE codigo = 'AUDIO'), 'retiro', NULL, true);

-- Asociar criterios de exclusión
INSERT INTO profesiograma_exclusiones (profesiograma_id, criterio_exclusion_id) VALUES
(1, (SELECT id FROM criterios_exclusion WHERE codigo = 'VIS_01')),
(1, (SELECT id FROM criterios_exclusion WHERE codigo = 'OST_01')),
(1, (SELECT id FROM criterios_exclusion WHERE codigo = 'OST_02')),
(1, (SELECT id FROM criterios_exclusion WHERE codigo = 'OST_03')),
(1, (SELECT id FROM criterios_exclusion WHERE codigo = 'AUD_01'));

-- Asociar inmunizaciones
INSERT INTO profesiograma_inmunizaciones (profesiograma_id, vacuna, esquema, obligatoria) VALUES
(1, 'Hepatitis B', 'Esquema 1-2-3', true),
(1, 'Toxoide Tetánico', 'Esquema completo', true),
(1, 'Fiebre Amarilla', 'Dosis única', false);